<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recent infection test calibration • inctools</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Recent infection test calibration">
<meta property="og:description" content="inctools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">inctools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.9006</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/EstimatingIncidence.html">Estimating incidence from cross-sectional data</a>
    </li>
    <li>
      <a href="../articles/Introduction.html">Overview of Incidence Estimation Package *inctools*</a>
    </li>
    <li>
      <a href="../articles/SurveyDesign.html">Survey design: power, precision and sample size</a>
    </li>
    <li>
      <a href="../articles/TestCalibration.html">Recent infection test calibration</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SACEMA/inctools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="TestCalibration_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Recent infection test calibration</h1>
            
            <h4 class="date">21 September 2018</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/SACEMA/inctools/blob/master/vignettes/TestCalibration.Rmd"><code>vignettes/TestCalibration.Rmd</code></a></small>
      <div class="hidden name"><code>TestCalibration.Rmd</code></div>

    </div>

    
    
<p>This vignette covers the use of functions <code>mdrical</code> and <code>frrcal</code>.</p>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>Incidence estimates from cross-sectional surveys using biomarkers for ‘recent infection’ require that the test for recent infection (usually an adapted diagnostic assay) be accurately characterised. The two critical parameters of test performance are the Mean Duration of Recent Infection (MDRI), denoted <span class="math inline">\(\Omega_T\)</span>, (with <span class="math inline">\(T\)</span> the recency cutoff time), and False Recent Rate (FRR), denoted <span class="math inline">\(\beta_T\)</span>. The explicit time cutoff <span class="math inline">\(T\)</span> was introduced by Kassanjee et al. <em>Epidemiology</em>, 2012.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> to differentiate between ‘true recent’ and ‘false recent’ results. Also see Kassanjee, McWalter, Welte. <em>AIDS Research and Human Retroviruses</em>, 2014.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>, which notes:</p>
<blockquote>
<p>To lead to an informative estimator, this cut-off, though theoretically arbitrary, must be chosen to reflect the temporal dynamic range of the test for recent infection; i.e. at a time T post infection, the overwhelming majority of infected people should no longer be testing “recent”, and furthermore, T should not be larger than necessary to achieve this criterion.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
</blockquote>
<p>MDRI is defined as the average time alive and returning a ‘recent’ result, while infected for times less than <span class="math inline">\(T\)</span>. FRR is defined as a cross sectional context specific proportion of subjects returning a ‘recent’ result while infected for longer than <span class="math inline">\(T\)</span>.</p>
<p>Test performance may be context-specific, and therefore, where available, local data should be used to calibrate tests. Often cross-sectional incidence surveys use a multi-step Recent Infection Testing Algorithm (RITA) and then the entire RITA must be appropriately calibrated. This may involve adapting MDRI estimates to account for the sensitivity of screening tests, or adapting FRR estimates based on weighted estimates for subpopulations such as treated individuals. Calibration should be performed using the same set of biomarkers used in a RITA, such as a viral load threshold to reduce false recency.</p>
</div>
<div id="estimating-mdri-using-binomial-regression" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-mdri-using-binomial-regression" class="anchor"></a>Estimating MDRI using binomial regression</h2>
<p>This package provides the function <code>mdrical</code> to estimate MDRI for a given biomarker or set of biomarkers from a dataset of based on the test being applied to well-characterised specimens and subjects. That is, time since ‘infection’ should be well-known, as well as test result(s). While ‘infection time’ can be variously defined as refering to the exposure event, date of first detectability on an RNA assay, Western Blot seroconversion, etc., it should be consistently used. If the reference event used in test calibration differs from test conversion on the screening assay or algorithm that is used define someone as HIV-positive in a RITA, then the MDRI needs to be appropriately adapted to cater for this difference.</p>
<p>Function <code>mdrical</code> estimates MDRI by fitting a model for the probability of testing ‘recent’ as a function of time since infection <span class="math inline">\(P_R(t)\)</span>. As an option, one of two functional forms (with their associated link functions) can be selected by the user. Fitting is performed using a generalised linear model (as implemented in the <em>glm2</em> package) to estimate parameters.</p>
<p>The linear binomial regression model takes the following form, with <span class="math inline">\(g()\)</span> the link function</p>
<p><span class="math display">\[\begin{equation}
g(P_R(t)) = f(t)
\end{equation}\]</span></p>
<p>If the argument <code>functional_forms</code> is specified with the value <code>"cloglog_linear"</code>, <span class="math inline">\(g()\)</span> is the complementary log-log link function and <span class="math inline">\(\ln(t)\)</span> as linear predictor of <span class="math inline">\(P_R(t)\)</span>, so that:</p>
<p><span class="math display">\[\begin{equation}
    \ln\left(-\ln(1-P_R(t)\right) = \beta_0 + \beta_1\ln(t)
\end{equation}\]</span></p>
<p>If the argument <code>functional_forms</code> is specified with the value <code>"logit_cubic"</code>, <span class="math inline">\(g()\)</span> is the complementary log-log link function and the linear predictor of <span class="math inline">\(P_R(t)\)</span> is a cubic polynomial in <span class="math inline">\(t\)</span>, so that:</p>
<p><span class="math display">\[\begin{equation}
    \ln{\left(\frac{P_R(t)}{1-P_R(t)}\right)} = \beta_0 + \beta_1t + \beta_2t^2 + \beta_3t^3
\end{equation}\]</span></p>
<p>In both cases, MDRI is the integral of <span class="math inline">\(P_R(t)\)</span> from <span class="math inline">\(0\)</span> to <span class="math inline">\(T\)</span>.</p>
<p><span class="math display">\[\begin{equation}
\Omega_T = \int_{0}^{T} P_R(t)dt
\end{equation}\]</span></p>
<p>The default behaviour is to implement both model forms if the argument <code>functional_forms</code> is omitted.</p>
<p>Confidence intervals are computed by means of subject-level bootstrapping, as measurements from subjects with more than one measurement in the dataset cannot be considered indpendent observations. An MDRI estimate is then calculated using the resampled data. The number of bootstrap iterations is specified using the argument <code>n_bootstraps</code>. We recommend 10,000 for reproducible confidence intervals and standard errors. To support subject level resampling, the subject identifier in the dataset must be specified using the <code>subid_var</code> argument.</p>
<p>In addition to specifying the value of <span class="math inline">\(T\)</span> (using the argument <code>recency_cutoff_time</code>), an <code>inclusion_time_threshold</code> is required, to <em>exclude</em> data points beyond a certain time (post infection). This is to prevent falsely recent measurements from unduly affecting the fit between <span class="math inline">\(0\)</span> and <span class="math inline">\(T\)</span>. This should typically be a value somewhat (but not too much) larger than <span class="math inline">\(T\)</span>.</p>
<p>To specify recency status, one can either supply a list of variables and thresholds (indicating in whether a result above or below the thresholds signifies recency) or specify the <code>recency_rule</code> as <code>"binary_data"</code>, in which case a 1 indicates recency.</p>
<div id="example-of-mdrical-using-the-complementary-log-log-functional-form-and-pre-classified-data" class="section level3">
<h3 class="hasAnchor">
<a href="#example-of-mdrical-using-the-complementary-log-log-functional-form-and-pre-classified-data" class="anchor"></a>Example of <code>mdrical</code> using the complementary log-log functional form and pre-classified data</h3>
<p>Load the package in order to use it</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.sacema.org/inctools/index.html">inctools</a></span><span class="op">)</span></code></pre></div>
<p>The dataset <code>excalibdata</code> contains example data from an evaluation of an assay measuring recency of infection. At an assay result of &lt;10, the specimen is considered to be recently infected. It further contains viral load data, which is commonly used to reduce false recency. For example, when recency is defined as assay result &lt;10 and viral load &gt; 1000, the FRR is substantially lower (but the MDRI is also reduced).</p>
<p>The first example provides a variable that has pre-classified results, and uses only the complementary log-log functional form.</p>
<p><em>Note that in these examples we perform only 1,000 bootstraps, but in real-life use no fewer than 10,000 is recommended.</em></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mdri</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdrical.html">mdrical</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">excalibdata</span>,
                subid_var <span class="op">=</span> <span class="st">"SubjectID"</span>,
                time_var <span class="op">=</span> <span class="st">"DaysSinceEDDI"</span>,
                recency_cutoff_time <span class="op">=</span> <span class="fl">730.5</span>,
                inclusion_time_threshold <span class="op">=</span> <span class="fl">800</span>,
                functional_forms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cloglog_linear"</span><span class="op">)</span>,
                recency_rule <span class="op">=</span> <span class="st">"binary_data"</span>,
                recency_vars <span class="op">=</span> <span class="st">"Recent"</span>,
                n_bootstraps <span class="op">=</span> <span class="fl">1000</span>,
                alpha <span class="op">=</span> <span class="fl">0.05</span>,
                plot <span class="op">=</span> <span class="cn">TRUE</span>,
                parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">mdri</span><span class="op">)</span></code></pre></div>
<pre><code>## $MDRI
## # A tibble: 1 x 8
##   FuncForm         PE   CI_LB   CI_UB      SE n_recent n_subjects n_observations
##   &lt;chr&gt;         &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;          &lt;dbl&gt;
## 1 cloglog_li… 248.145 221.871 275.385 13.9594      270        304            708
## 
## $Models
## $Models$cloglog_linear
## 
## Call:  glm2::glm2(formula = recency_status ~ 1 + I(log(time_since_eddi)), 
##     family = stats::binomial(link = "cloglog"), data = data, 
##     control = stats::glm.control(epsilon = tolerance, maxit = maxit, 
##         trace = FALSE))
## 
## Coefficients:
##             (Intercept)  I(log(time_since_eddi))  
##                  4.0858                  -0.9052  
## 
## Degrees of Freedom: 707 Total (i.e. Null);  706 Residual
## Null Deviance:       941.2 
## Residual Deviance: 747.4     AIC: 751.4
## 
## 
## $Plots
## $Plots$cloglog_linear</code></pre>
<pre><code>## 
## 
## $BSparms
## NULL</code></pre>
<p><img src="TestCalibration_files/figure-html/unnamed-chunk-3-1.png" width="624" style="display: block; margin: auto;"></p>
</div>
<div id="example-of-mdrical-using-the-logit-cubic-functional-form-and-two-independent-thresholds-on-biomarkers" class="section level3">
<h3 class="hasAnchor">
<a href="#example-of-mdrical-using-the-logit-cubic-functional-form-and-two-independent-thresholds-on-biomarkers" class="anchor"></a>Example of <code>mdrical</code> using the logit cubic functional form and two independent thresholds on biomarkers</h3>
<p>This example also specifies a vector of variables and a vector of paramaters to define recency, using the assay result and the viral load. The paramaters in the vector <code><a href="https://rdrr.io/r/base/c.html">c(10,0,1000,1)</a></code> mean that recency is defined as an assay biomarker reading below 10 and a viral load reading above 1000.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mdri</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdrical.html">mdrical</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">excalibdata</span>,
                subid_var <span class="op">=</span> <span class="st">"SubjectID"</span>,
                time_var <span class="op">=</span> <span class="st">"DaysSinceEDDI"</span>,
                recency_cutoff_time <span class="op">=</span> <span class="fl">730.5</span>,
                inclusion_time_threshold <span class="op">=</span> <span class="fl">800</span>,
                functional_forms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"logit_cubic"</span><span class="op">)</span>,
                recency_rule <span class="op">=</span> <span class="st">"independent_thresholds"</span>,
                recency_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Result"</span>,<span class="st">"VL"</span><span class="op">)</span>,
                recency_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">1000</span>,<span class="fl">1</span><span class="op">)</span>,
                n_bootstraps <span class="op">=</span> <span class="fl">1000</span>,
                alpha <span class="op">=</span> <span class="fl">0.05</span>,
                plot <span class="op">=</span> <span class="cn">TRUE</span>,
                parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">mdri</span><span class="op">)</span></code></pre></div>
<pre><code>## $MDRI
## # A tibble: 1 x 8
##   FuncForm         PE   CI_LB   CI_UB      SE n_recent n_subjects n_observations
##   &lt;chr&gt;         &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;          &lt;dbl&gt;
## 1 logit_cubic 259.223 230.240 288.328 14.8080      270        295            644
## 
## $Models
## $Models$logit_cubic
## 
## Call:  glm2::glm2(formula = recency_status ~ 1 + I(time_since_eddi) + 
##     I(time_since_eddi^2) + I(time_since_eddi^3), family = stats::binomial(link = "logit"), 
##     data = data, control = stats::glm.control(epsilon = tolerance, 
##         maxit = maxit, trace = FALSE))
## 
## Coefficients:
##          (Intercept)    I(time_since_eddi)  I(time_since_eddi^2)  
##            2.554e+00            -1.591e-02             2.184e-05  
## I(time_since_eddi^3)  
##           -1.471e-08  
## 
## Degrees of Freedom: 643 Total (i.e. Null);  640 Residual
## Null Deviance:       875.9 
## Residual Deviance: 635.3     AIC: 643.3
## 
## 
## $Plots
## $Plots$logit_cubic</code></pre>
<pre><code>## 
## 
## $BSparms
## NULL</code></pre>
<p><img src="TestCalibration_files/figure-html/unnamed-chunk-5-1.png" width="624" style="display: block; margin: auto;"></p>
</div>
<div id="obtaining-fitting-parameters-for-bootstrap-iterations" class="section level3">
<h3 class="hasAnchor">
<a href="#obtaining-fitting-parameters-for-bootstrap-iterations" class="anchor"></a>Obtaining fitting parameters for bootstrap iterations</h3>
<p>It is possible to output the fitting parameters for each bootstrap iteration, by using the switch <code>output_bs_parms = TRUE</code>. This provides the user with the family of <span class="math inline">\(P_{R}(t)\)</span> curves used to obtain the confidence intervals on the MDRI estimate, for potential further manipulation. Note that the functional form <code>cloglog_linear</code> form has two parameters (labeled <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>), and the <code>logit_cubic</code> form has four parameters (labeled <span class="math inline">\(\beta_0\)</span> to <span class="math inline">\(\beta_3\)</span>). In each case <span class="math inline">\(\beta_0\)</span> denotes the intercept. In order to use these parameters to obtain predicted probabilities of testing recent for given times since infection, the complementary log-log and logit link functions must be “inverted”, so that the equations giving predicted probabilities are</p>
<p><span class="math display">\[\begin{equation}
    P_R(t) = \exp(-\exp(\beta_{0} + \beta_{1}\ln(t)))
\end{equation}\]</span></p>
<p>and</p>
<p><span class="math display">\[\begin{equation}
    P_R(t) = \frac{1}{1 + \exp(-(\beta_{0} + \beta_{1}t + \beta_{2}t^2 + \beta_{3}t^3))}
\end{equation}\]</span></p>
<p>respectively.</p>
<p>As a demonstration, we perform only 10 bootstrap iterations in the example below:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mdri</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mdrical.html">mdrical</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">excalibdata</span>,
                subid_var <span class="op">=</span> <span class="st">"SubjectID"</span>,
                time_var <span class="op">=</span> <span class="st">"DaysSinceEDDI"</span>,
                recency_cutoff_time <span class="op">=</span> <span class="fl">730.5</span>,
                inclusion_time_threshold <span class="op">=</span> <span class="fl">800</span>,
                functional_forms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"cloglog_linear"</span>,<span class="st">"logit_cubic"</span><span class="op">)</span>,
                recency_rule <span class="op">=</span> <span class="st">"independent_thresholds"</span>,
                recency_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Result"</span>,<span class="st">"VL"</span><span class="op">)</span>,
                recency_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">1000</span>,<span class="fl">1</span><span class="op">)</span>,
                n_bootstraps <span class="op">=</span> <span class="fl">10</span>,
                parallel <span class="op">=</span> <span class="cn">FALSE</span>,
                alpha <span class="op">=</span> <span class="fl">0.05</span>,
                plot <span class="op">=</span> <span class="cn">TRUE</span>,
                output_bs_parms <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">mdri</span><span class="op">$</span><span class="va">Models</span><span class="op">)</span></code></pre></div>
<pre><code>## $cloglog_linear
## 
## Call:  glm2::glm2(formula = recency_status ~ 1 + I(log(time_since_eddi)), 
##     family = stats::binomial(link = "cloglog"), data = data, 
##     control = stats::glm.control(epsilon = tolerance, maxit = maxit, 
##         trace = FALSE))
## 
## Coefficients:
##             (Intercept)  I(log(time_since_eddi))  
##                  4.3171                  -0.9211  
## 
## Degrees of Freedom: 643 Total (i.e. Null);  642 Residual
## Null Deviance:       875.9 
## Residual Deviance: 675.9     AIC: 679.9
## 
## $logit_cubic
## 
## Call:  glm2::glm2(formula = recency_status ~ 1 + I(time_since_eddi) + 
##     I(time_since_eddi^2) + I(time_since_eddi^3), family = stats::binomial(link = "logit"), 
##     data = data, control = stats::glm.control(epsilon = tolerance, 
##         maxit = maxit, trace = FALSE))
## 
## Coefficients:
##          (Intercept)    I(time_since_eddi)  I(time_since_eddi^2)  
##            2.554e+00            -1.591e-02             2.184e-05  
## I(time_since_eddi^3)  
##           -1.471e-08  
## 
## Degrees of Freedom: 643 Total (i.e. Null);  640 Residual
## Null Deviance:       875.9 
## Residual Deviance: 635.3     AIC: 643.3</code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">mdri</span><span class="op">$</span><span class="va">BSparms</span><span class="op">)</span></code></pre></div>
<pre><code>## $cloglog_linear
## # A tibble: 10 x 2
##      beta0     beta1
##      &lt;dbl&gt;     &lt;dbl&gt;
##  1 3.29594 -0.761601
##  2 5.05694 -1.06022 
##  3 6.60235 -1.36734 
##  4 4.95220 -1.04441 
##  5 3.70290 -0.809043
##  6 5.60194 -1.15259 
##  7 4.69908 -1.00689 
##  8 5.00977 -1.09142 
##  9 3.93211 -0.845659
## 10 4.06603 -0.853132
## 
## $logit_cubic
## # A tibble: 10 x 4
##      beta0       beta1         beta2       beta3
##      &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;       &lt;dbl&gt;
##  1 2.35567 -0.0181791   0.0000429113 -4.70728e-8
##  2 2.98647 -0.0187627   0.0000275547 -1.76425e-8
##  3 2.59631 -0.0190237   0.0000344552 -2.71399e-8
##  4 2.67829 -0.0188507   0.0000357175 -2.89343e-8
##  5 2.69395 -0.0173708   0.0000235609 -1.52147e-8
##  6 2.43651 -0.0187123   0.0000327189 -2.46380e-8
##  7 1.97974 -0.00593447 -0.0000127699  1.37053e-8
##  8 2.27268 -0.0158627   0.0000232652 -1.49586e-8
##  9 2.39561 -0.0141260   0.0000185814 -1.35574e-8
## 10 2.85485 -0.0215979   0.0000391911 -2.82185e-8</code></pre>
</div>
</div>
<div id="estimating-frr-using-binomial-proportions-with-frrcal" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-frr-using-binomial-proportions-with-frrcal" class="anchor"></a>Estimating FRR using binomial proportions with <code>frrcal</code>
</h2>
<p>FRR is simply the binomially estimated probability of a <em>subject’s</em> measurements post-<span class="math inline">\(T\)</span> being ‘recent’ on the recency test. A binomial exact test is performed using <code>binom.test</code>. All of a subject’s measurements post-<span class="math inline">\(T\)</span> are evaluated and if the majority are recent, the subject is considered to have measured falsely recent. Inversely, if a majority are non-recent, the subject contributes a ‘true recent’ result. Each subject represents one trial. In the case that exactly half of a subject’s measurements are recent, they contribute 0.5 to the outcomes (which are rounded up to the nearest integer over all subjects).</p>
<p>This example calculates a false-recent rate, treating the data at subject level:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/frrcal.html">frrcal</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">excalibdata</span>,
             subid_var <span class="op">=</span> <span class="st">"SubjectID"</span>,
             time_var <span class="op">=</span> <span class="st">"DaysSinceEDDI"</span>,
             recency_cutoff_time <span class="op">=</span> <span class="fl">730.5</span>,
             recency_rule <span class="op">=</span> <span class="st">"independent_thresholds"</span>,
             recency_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Result"</span>,<span class="st">"VL"</span><span class="op">)</span>,
             recency_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">0</span>,<span class="fl">1000</span>,<span class="fl">1</span><span class="op">)</span>,
             alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 9
##      FRRest        SE     CI_LB     CI_UB alpha n_recent n_subjects
##       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt;    &lt;int&gt;      &lt;int&gt;
## 1 0.0300752 0.0104721 0.0130720 0.0583978  0.05        8        266
## # … with 2 more variables: n_observations &lt;int&gt;, ci_method &lt;chr&gt;</code></pre>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>Kassanjee, R., McWalter, T.A., Baernighausen, T. and Welte, A. “A new general biomarker-based incidence estimator.” Epidemiology; 2012, 23(5): 721-728.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Kassanjee, R., McWalter, T.A. and Welte, A. “Short Communication: Defining Optimality of a Test for Recent Infection for HIV Incidence Surveillance.” AIDS Research and Human Retroviruses; 2014, 30(1): 45-49.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Kassanjee, R., McWalter, T.A., Baernighausen, T. and Welte, A. “A new general biomarker-based incidence estimator.” Epidemiology; 2012, 23(5): 721-728.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Eduard Grebe, Alex Welte, Avery McIntosh, Petra Bäumler, Stefano Ongarello.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
